<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https:; img-src 'self' data: https:; media-src 'self' https:; frame-src https://www.youtube.com https://youtube.com;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <title>Bici Ros - Cycling Training Group</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-cyan: #00ffff;
            --primary-magenta: #ff00ff;
            --primary-purple: #8b5cf6;
            --dark-bg: #0f0f0f;
            --dark-card: #1a1a1a;
            --dark-border: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --success: #10b981;
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }

        /* Animated gradient background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.05) 0%, 
                rgba(255, 0, 255, 0.05) 25%, 
                rgba(139, 92, 246, 0.05) 50%, 
                rgba(0, 255, 255, 0.05) 75%, 
                rgba(255, 0, 255, 0.05) 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            z-index: -1;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes timerPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(255, 0, 255, 0.3); }
            50% { transform: scale(1.02); box-shadow: 0 0 30px rgba(255, 0, 255, 0.6); }
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        .slide-up {
            animation: slideInUp 0.4s ease-out;
        }

        /* Welcome Screen */
        .welcome-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            background: radial-gradient(circle at center, rgba(139, 92, 246, 0.1) 0%, transparent 70%);
        }

        .logo-main {
            width: 200px;
            height: 200px;
            margin-bottom: 2rem;
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(0, 255, 255, 0.3);
            animation: pulse 3s ease-in-out infinite;
        }

        .welcome-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary-cyan), var(--primary-magenta), var(--primary-purple));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-cyan);
            margin-bottom: 1rem;
            letter-spacing: 3px;
        }

        .welcome-email {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            letter-spacing: 1px;
        }

        .welcome-description {
            font-size: 1.1rem;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 600px;
            margin-bottom: 3rem;
        }

        .routine-selection {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .routine-button {
            background: linear-gradient(135deg, var(--primary-magenta), var(--primary-purple));
            color: white;
            border: none;
            padding: 1.2rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(255, 0, 255, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 200px;
        }

        .routine-button.trx {
            background: linear-gradient(135deg, var(--primary-cyan), var(--primary-purple));
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        }

        .routine-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 0, 255, 0.5);
        }

        .routine-button.trx:hover {
            box-shadow: 0 15px 40px rgba(0, 255, 255, 0.5);
        }

        /* Training Screen */
        .training-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-bottom: 120px;
        }

        .header {
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            border-bottom: 1px solid var(--dark-border);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-small {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .logo-small:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
        }

        .brand-info {
            display: flex;
            flex-direction: column;
        }

        .brand-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-cyan);
        }

        .brand-email {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .main-content {
            flex: 1;
            padding: 100px 2rem 2rem;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .exercise-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .exercise-counter {
            font-size: 1.2rem;
            color: var(--primary-cyan);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .exercise-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--text-primary), var(--primary-purple));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .series-info {
            font-size: 1.5rem;
            color: var(--primary-magenta);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .repetitions-info {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--primary-cyan);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .repetitions-title {
            font-size: 1.1rem;
            color: var(--primary-cyan);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .repetitions-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--text-primary);
        }

        .video-container {
            margin: 2rem 0;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .video-container iframe {
            width: 100%;
            height: 250px;
            border: none;
        }

        .info-tabs {
            display: flex;
            gap: 1rem;
            margin: 2rem 0 1rem;
        }

        .tab-button {
            flex: 1;
            background: rgba(26, 26, 26, 0.8);
            border: 2px solid var(--dark-border);
            color: var(--text-secondary);
            padding: 1rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary-cyan), var(--primary-purple));
            border-color: var(--primary-cyan);
            color: white;
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
        }

        .info-content {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--dark-border);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            line-height: 1.6;
            backdrop-filter: blur(5px);
        }

        .timer-section {
            text-align: center;
            margin: 2rem 0;
            padding: 2rem;
            background: rgba(26, 26, 26, 0.9);
            border-radius: 20px;
            border: 1px solid var(--dark-border);
        }

        .rest-info {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid var(--warning);
            border-radius: 15px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .rest-info-title {
            font-size: 1rem;
            color: var(--warning);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .rest-info-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .timer-display {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-magenta);
            margin-bottom: 1rem;
            font-family: 'Courier New', monospace;
        }

        .timer-display.pulsing {
            animation: timerPulse 1s ease-in-out infinite;
        }

        .action-button {
            background: linear-gradient(135deg, var(--success), var(--primary-cyan));
            color: white;
            border: none;
            padding: 1.2rem 2rem;
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
            width: 100%;
            max-width: 350px;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.5);
        }

        .action-button:disabled {
            background: linear-gradient(135deg, #4a5568, #2d3748);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .rest-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .rest-button {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid var(--warning);
            color: var(--warning);
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .rest-button:hover {
            background: var(--warning);
            color: var(--dark-bg);
        }

        .skip-button {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary-purple);
            color: var(--primary-purple);
        }

        .skip-button:hover {
            background: var(--primary-purple);
            color: white;
        }

        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(26, 26, 26, 0.98);
            backdrop-filter: blur(10px);
            padding: 1.2rem;
            border-top: 1px solid var(--dark-border);
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.5);
            min-height: 80px;
        }

        .nav-button {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary-purple);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            flex: 1;
            max-width: 180px;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 50px;
        }

        .nav-button:hover:not(:disabled) {
            background: var(--primary-purple);
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4);
            transform: translateY(-2px);
        }

        .nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .completion-message {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(0, 255, 255, 0.2));
            border: 2px solid var(--success);
            border-radius: 20px;
            margin: 2rem 0;
        }

        .completion-message h3 {
            color: var(--success);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .final-completion-message {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(0, 255, 255, 0.2));
            border: 2px solid var(--success);
            border-radius: 20px;
            margin: 2rem 0;
        }

        .final-completion-message h3 {
            color: var(--success);
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .intervals-reminder {
            background: rgba(255, 193, 7, 0.1);
            border: 2px solid var(--warning);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            text-align: center;
        }

        .intervals-reminder-title {
            color: var(--warning);
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .intervals-reminder-text {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.5;
        }

        /* Routine Switch Button */
        .routine-switch {
            position: fixed;
            top: 80px;
            right: 1rem;
            background: linear-gradient(135deg, var(--primary-cyan), var(--primary-purple));
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
        }

        .routine-switch:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.5);
        }

        /* Navigation in timer section */
        .timer-navigation {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .timer-nav-button {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary-purple);
            color: var(--text-primary);
            padding: 0.8rem 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            flex: 1;
            font-size: 0.9rem;
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer-nav-button:hover:not(:disabled) {
            background: var(--primary-purple);
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.4);
            transform: translateY(-2px);
        }

        .timer-nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Hide bottom navigation on training screen */
        .training-screen .navigation {
            display: none;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1500;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: var(--dark-card);
            border: 2px solid var(--primary-cyan);
            border-radius: 20px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
        }

        .modal h3 {
            color: var(--primary-cyan);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .modal-button {
            background: linear-gradient(135deg, var(--primary-magenta), var(--primary-purple));
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 0, 255, 0.4);
        }

        .modal-button.secondary {
            background: rgba(139, 92, 246, 0.2);
            border: 2px solid var(--primary-purple);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2.5rem;
            }

            .welcome-subtitle {
                font-size: 1rem;
                letter-spacing: 2px;
            }

            .exercise-title {
                font-size: 2rem;
            }

            .timer-display {
                font-size: 2.5rem;
            }

            .video-container iframe {
                height: 200px;
            }

            .main-content {
                padding: 80px 1rem 1rem;
            }

            .info-tabs {
                flex-direction: column;
                gap: 0.5rem;
            }

            .navigation {
                padding: 1rem;
            }

            .nav-button {
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
                max-width: none;
            }

            .rest-controls {
                flex-direction: column;
                gap: 0.5rem;
            }

            .brand-info {
                display: none;
            }

            .routine-selection {
                flex-direction: column;
                align-items: center;
            }

            .routine-button {
                min-width: 250px;
            }

            .routine-switch {
                top: 70px;
                right: 0.5rem;
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }

            .timer-navigation {
                flex-direction: column;
                gap: 0.8rem;
            }

            .timer-nav-button {
                padding: 1rem;
            }
        }

        /* Loading and notification animations */
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, var(--success), var(--primary-cyan));
            color: white;
            padding: 1rem 2rem;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            animation: slideInUp 0.3s ease-out;
        }

        .flash-effect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 255, 0.3);
            z-index: 999;
            animation: flash 0.5s ease-out;
        }

        @keyframes flash {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="welcome-screen fade-in">
        <img src="/lovable-uploads/01c937dc-57db-4d40-93cd-751fc488dfa4.png" alt="Bici Ros Logo" class="logo-main">
        <h1 class="welcome-title">Bici Ros</h1>
        <h2 class="welcome-subtitle">CYCLING TRAINING GROUP</h2>
        <div class="welcome-email">biciros@outlook.es</div>
        <p class="welcome-description">
            Rutinas de fuerza basadas en la ciencia para mejorar tu potencia, eficiencia y resistencia sobre la bicicleta. 
            Elige tu rutina y prepárate para completar tu entrenamiento.
        </p>
        <div class="routine-selection">
            <button class="routine-button" onclick="startTraining('fuerza')">Rutina de Fuerza</button>
            <button class="routine-button trx" onclick="startTraining('trx')">Rutina TRX</button>
        </div>
    </div>

    <!-- Training Screen -->
    <div id="trainingScreen" class="training-screen hidden">
        <header class="header">
            <img src="/lovable-uploads/01c937dc-57db-4d40-93cd-751fc488dfa4.png" alt="Bici Ros" class="logo-small" onclick="returnToHome()">
            <div class="brand-info">
                <span class="brand-name">Bici Ros</span>
                <span class="brand-email">biciros@outlook.es</span>
            </div>
        </header>

        <button id="routineSwitch" class="routine-switch" onclick="switchRoutine()">
            Cambiar a TRX
        </button>

        <main class="main-content">
            <div class="exercise-header">
                <div class="exercise-counter" id="exerciseCounter">1/6</div>
                <h3 class="exercise-title" id="exerciseTitle">Sentadilla Goblet</h3>
                <div class="series-info" id="seriesInfo">Serie 1 de 4</div>
                
                <div class="repetitions-info">
                    <div class="repetitions-title">Repeticiones a realizar:</div>
                    <div class="repetitions-value" id="repetitionsValue">5-6</div>
                </div>
            </div>

            <div class="video-container">
                <iframe id="exerciseVideo" 
                        src="https://www.youtube.com/embed/lmRIncjy39o?rel=0&modestbranding=1&playsinline=1" 
                        allowfullscreen>
                </iframe>
            </div>

            <div class="info-tabs">
                <button class="tab-button active" id="evidenceTab" onclick="showTab('evidence')">
                    🔬 Evidencia
                </button>
                <button class="tab-button" id="tipsTab" onclick="showTab('tips')">
                    💡 Consejos
                </button>
            </div>

            <div class="info-content" id="infoContent">
                Pilar fundamental para la fuerza del tren inferior. La ciencia demuestra que las sentadillas pesadas mejoran la economía de pedaleo hasta en un 5%, permitiéndote gastar menos energía a la misma potencia.
            </div>

            <div id="completionMessage" class="completion-message hidden">
                <h3>¡Ejercicio Completado!</h3>
                <p>Has terminado todas las series. ¡Excelente trabajo!</p>
            </div>

            <div id="finalCompletionMessage" class="final-completion-message hidden">
                <h3>🎉 ¡Rutina Completada! 🎉</h3>
                <p>¡Felicitaciones! Has completado toda la rutina de entrenamiento.</p>
                <div class="intervals-reminder">
                    <div class="intervals-reminder-title">📊 ¡No olvides registrar tu entrenamiento!</div>
                    <div class="intervals-reminder-text">
                        Anota esta sesión en <strong>intervals.icu</strong> para llevar un seguimiento de tu progreso y rendimiento.
                    </div>
                </div>
            </div>

            <div class="timer-section">
                <div class="rest-info" id="restInfo">
                    <div class="rest-info-title">Tiempo de descanso entre series:</div>
                    <div class="rest-info-value" id="restInfoValue">3:00</div>
                </div>
                
                <div class="timer-display" id="timerDisplay">03:00</div>
                <button class="action-button" id="actionButton" onclick="handleActionButton()">
                    ✅ Serie Completada - Iniciar Descanso
                </button>
                <div class="rest-controls hidden" id="restControls">
                    <button class="rest-button skip-button" onclick="showSkipModal()">
                        ⏭️ Saltar Descanso
                    </button>
                    <button class="rest-button" onclick="cancelRest()">
                        ❌ Cancelar Descanso
                    </button>
                </div>

                <!-- Navigation buttons moved here -->
                <div class="timer-navigation">
                    <button class="timer-nav-button" id="prevButtonTimer" onclick="previousExercise()" disabled>
                        ← Anterior
                    </button>
                    <button class="timer-nav-button" id="nextButtonTimer" onclick="nextExercise()">
                        Siguiente →
                    </button>
                </div>
            </div>
        </main>

        <footer class="navigation">
            <button class="nav-button" id="prevButton" onclick="previousExercise()" disabled>
                ← Anterior
            </button>
            <button class="nav-button" id="nextButton" onclick="nextExercise()">
                Siguiente →
            </button>
        </footer>
    </div>

    <!-- Skip Modal -->
    <div id="skipModal" class="modal-overlay hidden">
        <div class="modal">
            <h3>¿Qué quieres hacer?</h3>
            <p>Puedes saltar solo el descanso o pasar directamente al siguiente ejercicio.</p>
            <div class="modal-buttons">
                <button class="modal-button" onclick="skipToNextSeries()">
                    ⏭️ Saltar descanso y continuar serie
                </button>
                <button class="modal-button" onclick="skipToNextExercise()">
                    🏃‍♂️ Pasar al siguiente ejercicio
                </button>
                <button class="modal-button secondary" onclick="closeSkipModal()">
                    ❌ Cancelar
                </button>
            </div>
        </div>
    </div>

    <script>
        // Rutina de ejercicios de fuerza
        const rutinaFuerza = [
            {
                nombre: "Sentadilla Goblet",
                series: 4,
                repeticiones: "5-6",
                descanso: 180,
                videoUrl: "https://www.youtube.com/embed/lmRIncjy39o?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Pilar fundamental para la fuerza del tren inferior. La ciencia demuestra que las sentadillas pesadas mejoran la economía de pedaleo hasta en un 5%, permitiéndote gastar menos energía a la misma potencia.",
                consejos: "Mantén la espalda recta, el pecho erguido y baja hasta que tus caderas superen la altura de las rodillas. El peso debe estar en todo el pie, no solo en la punta."
            },
            {
                nombre: "Peso Muerto Rumano",
                series: 3,
                repeticiones: "6",
                descanso: 120,
                videoUrl: "https://www.youtube.com/embed/O-MLxyVYRBY?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Fortalece toda la cadena posterior (isquiotibiales y glúteos), crucial para la fase de tracción del pedaleo y para prevenir dolores de espalda baja.",
                consejos: "Piensa en empujar la cadera hacia atrás, no en bajar el torso. Mantén una ligera flexión de rodillas y la barra siempre cerca de tus piernas."
            },
            {
                nombre: "Sentadilla Búlgara",
                series: 3,
                repeticiones: "6 (por pierna)",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/x_k90ghjPPw?rel=0&modestbranding=1&playsinline=1",
                evidencia: "El trabajo unilateral corrige desequilibrios de fuerza entre las piernas, imitando la acción individual de cada pierna al pedalear y mejorando la estabilidad de la pelvis.",
                consejos: "Asegúrate de que la rodilla delantera no sobrepase la punta del pie al bajar. Controla el movimiento en todo momento, especialmente la bajada (fase excéntrica)."
            },
            {
                nombre: "Saltos al Cajón",
                series: 3,
                repeticiones: "5",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/bbFEYR3i8JU?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Entrena la potencia explosiva (Rate of Force Development). Esto se traduce directamente en una mayor capacidad de sprint y aceleración en subidas cortas y empinadas.",
                consejos: "El objetivo es la explosividad, no la altura. Aterriza suavemente sobre el cajón como un 'ninja'. IMPORTANTE: Baja del cajón dando un paso atrás, NUNCA saltando hacia abajo."
            },
            {
                nombre: "Plancha Frontal",
                series: 3,
                repeticiones: "45-60 seg",
                descanso: 60,
                videoUrl: "https://www.youtube.com/embed/HCPUoQdvh5A?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Un core fuerte es la plataforma que transfiere la fuerza de las piernas a los pedales. La plancha mejora la rigidez del torso, evitando la pérdida de energía.",
                consejos: "Aprieta los glúteos y el abdomen para mantener una línea recta desde los talones hasta la cabeza. Evita que la cadera se hunda o se eleve demasiado."
            },
            {
                nombre: "Press Pallof",
                series: 3,
                repeticiones: "8 (por lado)",
                descanso: 60,
                videoUrl: "https://www.youtube.com/embed/gHGLwQGvtxg?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Ejercicio de anti-rotación. Crítico para la estabilidad sobre la bici, especialmente en MTB para controlar la dirección en terrenos irregulares y al pedalear de pie en carretera.",
                consejos: "Mantén el core apretado y resiste el impulso de la goma de girar tu torso. El movimiento de los brazos debe ser lento y controlado."
            }
        ];

        // Rutina TRX para ciclistas
        const rutinaTRX = [
            {
                nombre: "Plancha TRX",
                series: 3,
                repeticiones: "30-45 seg",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/s62BuNUE6Kc?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Un core fuerte es esencial para transferir eficientemente la potencia de las piernas a los pedales. La plancha TRX añade inestabilidad, activando más músculos estabilizadores del core.",
                consejos: "Coloca los pies en los estribos del TRX y apóyate con los antebrazos o las manos. Mantén el cuerpo recto como una tabla, activando intensamente los glúteos y el abdomen para evitar que las caderas se hundan."
            },
            {
                nombre: "Sentadilla TRX",
                series: 3,
                repeticiones: "10-12",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/DTXphTGYd0g?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Trabaja los cuádriceps y glúteos, músculos principales para la potencia de pedaleo. El TRX permite realizar el ejercicio con una forma controlada y adaptable a diferentes niveles.",
                consejos: "Sujeta las asas del TRX, inclínate ligeramente hacia atrás y baja las caderas como si fueras a sentarte en una silla. Mantén la espalda recta, el torso erguido y las rodillas alineadas con los pies."
            },
            {
                nombre: "Curl de Isquiotibiales TRX",
                series: 3,
                repeticiones: "10-12",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/RkEHyudfkyM?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Fortalece los isquiotibiales y los glúteos, músculos esenciales para la fase de tracción del pedaleo y para equilibrar la fuerza con los cuádriceps, previniendo desequilibrios musculares.",
                consejos: "Acuéstate boca arriba, coloca los talones en los estribos del TRX. Eleva las caderas del suelo y flexiona las rodillas, llevando los talones hacia los glúteos. Mantén las caderas elevadas durante todo el movimiento."
            },
            {
                nombre: "Remo TRX",
                series: 3,
                repeticiones: "10-12",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/N_14s8zFOms?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Fortalece la espalda superior (dorsales, romboides, trapecio) y los bíceps, crucial para mantener una buena postura sobre la bicicleta, mejorar el control del manillar y reducir la fatiga en rutas largas.",
                consejos: "De cara al punto de anclaje, inclínate hacia atrás manteniendo el cuerpo en línea recta. Tira del pecho hacia las manos, apretando los omóplatos y manteniendo los codos cerca del cuerpo."
            },
            {
                nombre: "Press de Pecho TRX",
                series: 3,
                repeticiones: "10-12",
                descanso: 90,
                videoUrl: "https://www.youtube.com/embed/i_45-JMoXg4?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Trabaja los pectorales, tríceps y deltoides anteriores. Contribuye a la estabilidad del tronco y la capacidad de empuje, beneficioso para el manejo de la bicicleta y la prevención de la fatiga en la parte superior del cuerpo.",
                consejos: "De espaldas al punto de anclaje, sujeta las asas e inclínate hacia adelante, formando una línea recta. Dobla los codos para bajar el pecho entre las manos y luego empuja para extender los brazos. Mantén el core activado."
            },
            {
                nombre: "Sentadilla Búlgara TRX",
                series: 3,
                repeticiones: "8-10 (por pierna)",
                descanso: 120,
                videoUrl: "https://www.youtube.com/embed/A5MjNft73Ag?rel=0&modestbranding=1&playsinline=1",
                evidencia: "Mejora la fuerza unilateral de las piernas y la estabilidad de la cadera, crucial para corregir desequilibrios musculares comunes en ciclistas y mejorar la eficiencia del pedaleo.",
                consejos: "Coloca el empeine de un pie en el estribo del TRX detrás de ti. Baja la rodilla trasera hacia el suelo, concentrando el peso en la pierna delantera. Mantén el torso erguido y la rodilla delantera alineada con los dedos del pie."
            }
        ];

        // Estado de la aplicación
        let ejercicioActual = 0;
        let serieActual = 1;
        let currentTab = 'evidence';
        let timerInterval = null;
        let isResting = false;
        let timeRemaining = 0;
        let rutina = rutinaFuerza;
        let currentRoutineType = 'fuerza';

        // Bell sound function with higher volume
        function playBellSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create bell-like sound with multiple harmonics and higher volume
                const frequencies = [800, 1000, 1200, 1600];
                const duration = 2;
                
                frequencies.forEach((freq, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                    oscillator.type = 'sine';
                    
                    const volume = 0.5 / (index + 1); // Increased volume significantly
                    gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + duration);
                });
            } catch (e) {
                console.log('Audio no disponible');
            }
        }

        // Funciones principales
        function startTraining(routineType) {
            currentRoutineType = routineType;
            rutina = routineType === 'trx' ? rutinaTRX : rutinaFuerza;
            ejercicioActual = 0;
            serieActual = 1;
            currentTab = 'evidence';
            
            // Update switch button text
            const switchButton = document.getElementById('routineSwitch');
            switchButton.textContent = routineType === 'fuerza' ? 'Cambiar a TRX' : 'Cambiar a Fuerza';
            
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('trainingScreen').classList.remove('hidden');
            document.getElementById('trainingScreen').classList.add('fade-in');
            updateDisplay();
        }

        function updateDisplay() {
            const ejercicio = rutina[ejercicioActual];
            
            // Actualizar información del ejercicio
            document.getElementById('exerciseCounter').textContent = `${ejercicioActual + 1}/${rutina.length}`;
            document.getElementById('exerciseTitle').textContent = ejercicio.nombre;
            document.getElementById('seriesInfo').textContent = `Serie ${serieActual} de ${ejercicio.series}`;
            document.getElementById('repetitionsValue').textContent = ejercicio.repeticiones;
            
            // Actualizar información de descanso
            const restMinutes = Math.floor(ejercicio.descanso / 60);
            const restSeconds = ejercicio.descanso % 60;
            const restTime = restMinutes > 0 ? `${restMinutes}:${restSeconds.toString().padStart(2, '0')}` : `${ejercicio.descanso}s`;
            document.getElementById('restInfoValue').textContent = restTime;
            
            // Actualizar video
            document.getElementById('exerciseVideo').src = ejercicio.videoUrl;
            
            // Actualizar contenido de información
            updateInfoContent();
            
            // Actualizar botones de navegación
            updateNavigationButtons();
            
            // Resetear timer display
            updateTimerDisplay(ejercicio.descanso);
            
            // Ocultar mensajes de completado y controles de descanso
            document.getElementById('completionMessage').classList.add('hidden');
            document.getElementById('finalCompletionMessage').classList.add('hidden');
            document.getElementById('restControls').classList.add('hidden');
            
            // Resetear estado del temporizador
            clearTimer();
            updateActionButton();
        }

        function updateInfoContent() {
            const ejercicio = rutina[ejercicioActual];
            const content = currentTab === 'evidence' ? ejercicio.evidencia : ejercicio.consejos;
            document.getElementById('infoContent').textContent = content;
        }

        function showTab(tab) {
            currentTab = tab;
            
            // Actualizar botones de tab
            document.getElementById('evidenceTab').classList.toggle('active', tab === 'evidence');
            document.getElementById('tipsTab').classList.toggle('active', tab === 'tips');
            
            // Actualizar contenido
            updateInfoContent();
        }

        function updateNavigationButtons() {
            // Update bottom navigation
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            
            prevButton.disabled = ejercicioActual === 0;
            
            if (ejercicioActual === rutina.length - 1) {
                nextButton.textContent = 'Finalizar';
            } else {
                nextButton.textContent = 'Siguiente →';
            }

            // Update timer navigation
            const prevButtonTimer = document.getElementById('prevButtonTimer');
            const nextButtonTimer = document.getElementById('nextButtonTimer');
            
            prevButtonTimer.disabled = ejercicioActual === 0;
            
            if (ejercicioActual === rutina.length - 1) {
                nextButtonTimer.textContent = 'Finalizar';
            } else {
                nextButtonTimer.textContent = 'Siguiente →';
            }
        }

        function handleActionButton() {
            const ejercicio = rutina[ejercicioActual];
            
            if (!isResting) {
                // Completar serie y iniciar descanso
                if (serieActual < ejercicio.series) {
                    startRest();
                } else {
                    // Ejercicio completado
                    showCompletionMessage();
                }
            } else {
                // Iniciar siguiente serie
                endRest();
                serieActual++;
                updateDisplay();
            }
        }

        function startRest() {
            const ejercicio = rutina[ejercicioActual];
            isResting = true;
            timeRemaining = ejercicio.descanso;
            
            // Mostrar controles de descanso
            document.getElementById('restControls').classList.remove('hidden');
            
            updateActionButton();
            startTimer();
        }

        function startTimer() {
            const timerDisplay = document.getElementById('timerDisplay');
            timerDisplay.classList.add('pulsing');
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay(timeRemaining);
                
                if (timeRemaining <= 0) {
                    endTimer();
                }
            }, 1000);
        }

        function clearTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            const timerDisplay = document.getElementById('timerDisplay');
            timerDisplay.classList.remove('pulsing');
            isResting = false;
            document.getElementById('restControls').classList.add('hidden');
        }

        function endTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            const timerDisplay = document.getElementById('timerDisplay');
            timerDisplay.classList.remove('pulsing');
            
            // Play bell sound
            playBellSound();
            
            // Show flash effect
            showFlashEffect();
            
            // Show notification
            showNotification('¡Descanso terminado!');
            
            // Automatically advance to next series
            setTimeout(() => {
                if (serieActual < rutina[ejercicioActual].series) {
                    serieActual++;
                    updateDisplay();
                    endRest();
                    showNotification('Iniciando siguiente serie');
                } else {
                    // Exercise completed, show completion message
                    showCompletionMessage();
                    updateActionButton();
                }
            }, 1500);
        }

        function skipRest() {
            if (isResting && timerInterval) {
                clearTimer();
                showNotification('Descanso saltado');
                updateActionButton();
            }
        }

        function cancelRest() {
            if (isResting && timerInterval) {
                clearTimer();
                showNotification('Descanso cancelado');
                updateActionButton();
            }
        }

        function endRest() {
            clearTimer();
        }

        function updateTimerDisplay(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            const formattedTime = `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = formattedTime;
        }

        function updateActionButton() {
            const actionButton = document.getElementById('actionButton');
            const ejercicio = rutina[ejercicioActual];
            
            if (isResting && timeRemaining > 0) {
                actionButton.textContent = '⏰ Descansando... Espera o salta el descanso';
                actionButton.disabled = true;
            } else if (isResting && timeRemaining <= 0) {
                actionButton.textContent = '🚀 ¡Descanso terminado! - Iniciar siguiente serie';
                actionButton.disabled = false;
            } else if (serieActual >= ejercicio.series) {
                actionButton.textContent = '✅ Ejercicio completado';
                actionButton.disabled = true;
            } else {
                actionButton.textContent = '✅ Serie Completada - Iniciar Descanso';
                actionButton.disabled = false;
            }
        }

        function showCompletionMessage() {
            document.getElementById('completionMessage').classList.remove('hidden');
            document.getElementById('completionMessage').classList.add('slide-up');
            updateActionButton();
        }

        function previousExercise() {
            if (ejercicioActual > 0) {
                clearTimer();
                ejercicioActual--;
                serieActual = 1;
                currentTab = 'evidence';
                updateDisplay();
                showTab('evidence');
            }
        }

        function nextExercise() {
            if (ejercicioActual < rutina.length - 1) {
                clearTimer();
                ejercicioActual++;
                serieActual = 1;
                currentTab = 'evidence';
                updateDisplay();
                showTab('evidence');
            } else {
                // Finalizar rutina
                finishTraining();
            }
        }

        function finishTraining() {
            clearTimer();
            
            // Mostrar mensaje final de completación
            document.getElementById('finalCompletionMessage').classList.remove('hidden');
            document.getElementById('finalCompletionMessage').classList.add('slide-up');
            
            // Ocultar otros elementos
            document.getElementById('completionMessage').classList.add('hidden');
            document.getElementById('restControls').classList.add('hidden');
            
            // Actualizar botón de acción
            const actionButton = document.getElementById('actionButton');
            actionButton.textContent = '🏠 Volver al Inicio';
            actionButton.disabled = false;
            actionButton.onclick = function() {
                returnToHome();
            };
            
            showNotification('¡Entrenamiento completado! ¡Excelente trabajo!');
        }

        function returnToHome() {
            document.getElementById('trainingScreen').classList.add('hidden');
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('welcomeScreen').classList.add('fade-in');
            
            // Reset state
            ejercicioActual = 0;
            serieActual = 1;
            currentTab = 'evidence';
            rutina = rutinaFuerza;
            currentRoutineType = 'fuerza';
            
            // Reset action button
            const actionButton = document.getElementById('actionButton');
            actionButton.onclick = function() {
                handleActionButton();
            };
        }

        function showFlashEffect() {
            const flash = document.createElement('div');
            flash.className = 'flash-effect';
            document.body.appendChild(flash);
            
            setTimeout(() => {
                document.body.removeChild(flash);
            }, 500);
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 2000);
        }

        // Prevenir zoom en dispositivos móviles
        document.addEventListener('touchstart', function(event) {
            if (event.touches.length > 1) {
                event.preventDefault();
            }
        });

        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Bici Ros Cycling Trainer cargado correctamente');
        });

        // Skip Modal Functions
        function showSkipModal() {
            document.getElementById('skipModal').classList.remove('hidden');
        }

        function closeSkipModal() {
            document.getElementById('skipModal').classList.add('hidden');
        }

        function skipToNextSeries() {
            closeSkipModal();
            if (isResting && timerInterval) {
                clearTimer();
                showNotification('Descanso saltado - Siguiente serie');
                updateActionButton();
            }
        }

        function skipToNextExercise() {
            closeSkipModal();
            clearTimer();
            nextExercise();
            showNotification('Ejercicio saltado');
        }

        // Routine switching function
        function switchRoutine() {
            const switchButton = document.getElementById('routineSwitch');
            if (currentRoutineType === 'fuerza') {
                currentRoutineType = 'trx';
                rutina = rutinaTRX;
                switchButton.textContent = 'Cambiar a Fuerza';
            } else {
                currentRoutineType = 'fuerza';
                rutina = rutinaFuerza;
                switchButton.textContent = 'Cambiar a TRX';
            }
            
            // Reset to first exercise when switching
            ejercicioActual = 0;
            serieActual = 1;
            currentTab = 'evidence';
            updateDisplay();
            showNotification(`Cambiado a rutina ${currentRoutineType === 'fuerza' ? 'de Fuerza' : 'TRX'}`);
        }
    </script>
</body>
</html>
